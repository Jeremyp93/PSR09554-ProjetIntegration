@using Helpers

@{
    ViewBag.Title = "GetReservationUser";
}


<link rel="stylesheet" href="~/Content/bootstrap.min.css">
<script src="~/Scripts/bootstrap.min.js"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/momentjs/latest/moment.min.js"></script>

<h2>GetReservationUser</h2>

<div class="container">
    <div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true"></div>
</div>

@{
    var path = CUtil.GetValueBaseOnKey("apiBaseUrl");
    var ecuriePath = path + CUtil.GetValueBaseOnKey("GameUrl");
}

<script>
    var token = '@ViewBag.Token';
    var headers = {};
    if (token) {
        headers.Authorization = 'Bearer ' + token;
    }

    $(document).ready(function() {
        LoadReservation();
    });

    function LoadReservation() {
        $.ajax({
            url: '@ecuriePath' + 'MesReservations',
            type: 'GET',
            headers: headers,
            success: function (data) {
                var j = 1;
                var array = [];
                $.each(data,
                    function (i, v) {
                        array.push('<div class="panel panel-default">');
                        array.push('<div class="panel-heading" role="tab" id="heading' + j + '">');
                        array.push('<h4 class="panel-title">');
                        array.push('<a class="collapsed" role="button" data-toggle="collapse" data-parent="#accordion" href="#collapse' + j + '" aria-expanded="false" aria-controls="collapseTwo">' + moment(v.heureDebut).format("DD-MM-YYYY") + ' : ' + v.typeDeCours + ' - ' + v.discipline + '</a>');
                        array.push('</h4>');
                        array.push('</div>');
                        array.push('<div id="collapse'+j+'" class="panel-collapse collapse" role="tabpanel" aria-labelledby="heading'+j+'">');
                        array.push('<div class="panel-body">');
                        array.push('test'+j);
                        array.push('</div>');
                        array.push('</div>');
                        array.push('</div>');
                        j = j + 1;
                    });
                $('#accordion').append(array.join(''));
                $('.collapse').collapse();
            },
            error: function(error) {
                alert('failed : ' + error);
            }
        });
    }
</script>

